setwd("D:/RDSML April 2025/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-38 ðŸ‘‰ One-way ANOVA in R (Part-2)")
PlantDataset <- PlantGrowth
View(PlantDataset)
library(dplyr)
stats <- PlantDataset %>%
group_by(group) %>%
summarise(
mean = mean(weight),
sd = sd(weight),
se = sd(weight) / sqrt(n())
)
print(stats)
boxplot(weight ~ group, data = PlantGrowth,
main = "PlantGrowth data",
ylab = "Dried weight of plants",
col = "lightgray"
)
library(ggpubr)
ggline(PlantGrowth,
x = "group",
y = "weight",
add = c("mean_se", "jitter")
)
anova <- aov(weight ~ group, data = PlantDataset)
summary(anova)
# Tukey multiple pairwise-comparisons
TukeyHSD(anova)
# Homogeneity of variance must be maintained among each group data.
# Visualizing homogeneity of variance
plot(anova, 1)
#
library(car)
leveneTest(weight ~ group, data = PlantDataset)
# When homogeneity of variance is not maintained,
# ANOVA test with no assumption of equal variances,
oneway.test(weight ~ group, data = PlantDataset)
# Another test when homogeneity of variance is not maintained
# Pairwise t-tests with no assumptions of equal variances
pairwise.t.test(PlantDataset$weight, PlantDataset$group,
p.adjust.method = "BH", pool.sd = FALSE)
# Checking for normal distribution
plot(anova, 2)
# Statistically identify if data are in normal distribution
# Extracting the residuals
aov_res <- residuals(object = anova)
aov_res
# Shapiro-Wilk test for checking normal distribution
shapiro.test(aov_res)
# If not normally distributed, nonparametric equivalent of One-way ANOVA,
# Kruskal-Wallis H test is run.
kruskal.test(weight ~ group, data = PlantDataset)
# Since p value is less than 0.05, we need to run the post hoc test for
# Kruskal-Wallis H test (pairwise test)
pairwise.wilcox.test(PlantDataset$weight, PlantDataset$group,
p.adjust.method = "BH")
